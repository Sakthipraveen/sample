---
  - hosts: all
    become: true
    gather_facts: True
    tasks:
      - name: install apache on redhat or centos instances
        yum: name=httpd state=present
        when: ansible_os_family == "RedHat"

      - name: install apache on debian or ubuntu instances
        apt: name=apache2 state=present
        when: ansible_os_family == "Debian"

      - name: enable apache on startup and start service for redhat or centos
        service: name=httpd enabled=yes state=started
        when: ansible_os_family == "RedHat"

      - name: enable apache on startup and start service for debian or ubuntu
        service: name=apache2 enabled=yes state=started
        when: ansible_os_family == "Debian"

      - name: pull an image
        shell: docker pull sakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539

      - name: Docker push to slave
        shell: docker export sakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539 | gzip > csakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539.gz
        shell: scp sakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539.gz ec2-user@13.232.130.147:.
        shell: zcat sakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539.gz | docker import - sakthipraveen/devops:22356c53ab39a94d2eb0b1142b567b3eab280539
